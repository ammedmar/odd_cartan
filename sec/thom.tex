% !TEX root = ../odd_cartan.tex

\section{An effective proof of Thom's theorem}\label{s:thom}

\noindent Let $(A,\psi)$ be a May--Steenrod complex.
Recall that
\[
\rD_i^p \colon \rH_n(A; \Fp) \to \rH_{np+i}(A; \Fp)
\]
is defined, after extending scalar to $\Fp$, by sending a cycle $a$ to $\psi_i(a^{\ot p})$.
Thom's \cref{t:thom} states that the map $\rD_i^p$ is $0$ unless for some $\varepsilon \in \{0,1\}$ either: $\bars{a}$ is even and $i+\varepsilon$ is an even multiple of $(p-1)$ or $\bars{a}$ is odd and $i+\varepsilon$ is an odd multiple of $(p-1)$.
We will lift to the chain level Steenrod's proof of this statement.

Throughout this section we fix a primitive root $k \in \Fp$\,, i.e., $k^p = 1$ and $k^\ell \neq 1$ for $\ell \in \set{1,\dots,p-1}$.

\subsection{Thom $i$-boundary constructions}

A \textit{Thom $i$-boundary construction for $(A,\psi)$ at $p$} is an assignment of an element $\theta_i^p(a)$ in $A$ to every mod~$p$ cycle $a$ in $A$ such that, in $A \ot \Fp$,
\[
\bd \theta_i^p(a) = c_i^p(a) \, \psi_i(a^{\ot p})
\]
for some non-zero $c_i^p(a) \in \Fp$ unless, for some $\varepsilon \in \set{0,1}$, either: $\bars{a}$ is even and $i+\varepsilon$ is an even multiple of $(p-1)$ or $\bars{a}$ is odd and $i+\varepsilon$ is an odd multiple of $(p-1)$.

Clearly, the existence of a Thom $i$-boundary construction for each $i \in \N$ implies Thom's Theorem \cref{t:thom}.

\subsection{The map $\lambda$}

The linear map $\lambda \colon \cW(p) \to \cW(p)$ is defined by
\[
\lambda(\rho^s e_{2i}) = k^i \rho^{ks} e_{2i}, \qquad
\lambda(\rho^s e_{2i+1}) = k^i (1+\rho+\dots+\rho^{k-1}) \rho^{ks} e_{2i+1}.
\]

\begin{lemma}
	$\lambda$ is a chain map equivariant for the group homomorphism
	\begin{align*}
		\cyc_p &\to \cyc_p \\
		\rho &\mapsto \rho^k.
	\end{align*}
\end{lemma}

\begin{proof}
	Recall that $N$ equals $1+\rho+\dots+\rho^{p-1}$.
	Using that $\rho N = N$ we have
	\[
	\bd \comp \lambda(\rho^s e_{2i}) = k^i \rho^{ks} \bd (e_{2i}) = k^i \rho^{ks} N e_{2i-1} = k^i N e_{2i-1}
	\]
	and
	\begin{align*}
		\lambda \comp \bd(\rho^s e_{2i}) &= \lambda(N e_{2i-1}) = k^{i-1}(1+\rho+\dots+\rho^{k-1}) (1+\rho^k+\dots+\rho^{kp-k}) e_{2i-1} \\ &=
		k^i N e_{2i-1}
	\end{align*}
	since $(1+\rho+\dots+\rho^{k-1}) (1+\rho^k+\dots+\rho^{kp-k}) = kN$.
	This proves the claim for even degrees.
	Recall that $T$ equals $\rho - 1$.
	For odd degrees, we have
	\begin{multline*}
		\bd \comp \lambda(\rho^s e_{2i+1}) = k^i (1+\rho+\dots+\rho^{k-1}) \rho^{ks} \bd (e_{2i+1}) \\
		= k^i (1+\rho+\dots+\rho^{k-1}) \rho^{ks} T e_{2i} = k^i \rho^{ks} (\rho^k-1) e_{2i}
	\end{multline*}
	and
	\[
	\lambda \comp \bd(\rho^s e_{2i+1}) = \lambda(\rho^s T e_{2i}) = k^i\rho^{ks}(\rho^k-1) e_{2i}.
	\]
	This concludes the proof.
\end{proof}

\subsection{The element $\gamma$}

Let $\gamma \in \sym_p \cong \mathrm{Bij}(\Fp, \Fp)$ be defined by $\gamma(q) = kq$.
We remark that $\gamma$ is an odd permutation because it fixes $q = 0$ and is a $p-1$ cycle on the remaining elements since $k$ is a primitive root of unity.
For $\sigma \in \sym_p$ we use the notation $\sigma^\gamma = \gamma \sigma \gamma^{-1}$, where $\sym_p \supset \cyc_p \cong \Fp$.
Notice that $\rho^\gamma = \rho^k$ since $\rho^\gamma(q) = \gamma \rho(k^{-1}q) = \gamma(k^{-1} q + 1) = q + k = \rho^k(q)$ for any $q \in \Fp$.
This implies that the induced simplicial map $\EE\sym_p \to \EE\sym_p$ restricts to a simplicial map $\EE\cyc_p \to \EE\cyc_p$.
We denote its induced chain map by $\gamma_\ast \colon \cC(p) \to \cC(p)$, which is $\cyc_p$-equivariant if the action of $\rho$ on the target is by $\rho^k$.

\subsection{Thom relators}

A \textit{Thom relator for $(A, \psi)$ at $p$} is a homotopy from $\psi \comp \lambda$ to $\gamma \comp \psi$ which is equivariant with respect to the homomorphisms $\rho \to \rho^k$.
Explicitly, a degree 1 map
\[
L_\psi^p \colon \cW(p) \to \End(A)(p)
\]
satisfying
\[
\bd_{\End(A)(p)} \comp L_\psi^p + L_\psi^p \comp \bd_{\cW(p)} = \gamma \comp \psi - \psi \comp \lambda
\]
and
\[
L_\psi^p \comp \rho = \rho^k \comp L_\psi^p \,,
\]
where the action of $\rho^k$ on $\End(A)(p) = \Hom(A^{\ot p}, A)$ is the usual one, explicitly described in \cref{fn:symmetric_action_on_hom}.

\begin{theorem}
	If $L_\psi^p$ is a Thom relator for $(A, \psi)$ at $p$ then
	\[
	\theta_i^p(a) = L_\psi^p(e_i)(a^{\ot p})
	\]
	defines a Thom $i$-boundary construction for $(A, \psi)$ at $p$.
\end{theorem}

\begin{proof}
	Let us write $L,\theta_i, \End(A)$, and $\cW$ instead of $L_\psi^p, \theta_i^p, \End(A)(p)$, and $\cW(p)$.
	Since $a$ is a mod~$p$ cycle,
	\begin{align*}
		(\bd_A \comp\; \theta_i)(a) & =
		\bd_A \comp\, L(e_i)(a^{\ot p}) \\ & =
		\big(\bd_{\End(A)} L(e_i) - L(e_i) \comp \bd_{A^{\ot p}} \big)(a^{\ot p})\\ & =
		\big((\gamma \comp \psi - \psi \comp \lambda)(e_i) - L(\bd_\cW e_i)\big) (a^{\ot p}).
	\end{align*}
	Since $\rho$ is an even permutation, $a^{\ot p} \rho = a^{\ot p}$ and
	\begin{align*}
		&L(\bd e_{2\ell})(a^{\ot p}) = L(N e_{2\ell-1})(a^{\ot p}) = (1+\rho^k+\dots+\rho^{kp-k})L(e_{2\ell-1}) (a^{\ot p}) = 0, \\
		&L(\bd e_{2\ell+1})(a^{\ot p}) = L(T e_{2\ell})(a^{\ot p}) = (\rho^k - 1) L(e_{2\ell})(a^{\ot p}) = 0.
	\end{align*}
	Since $\gamma$ is an odd permutation, $a^{\ot p} \gamma = (-1)^{\bars{a}} a^{\ot p}$ and
	\begin{align*}
		(\bd_A \comp\, \theta_i)(a) & =
		(\psi \comp \lambda - \gamma \comp \psi)(e_i)(a^{\ot p}) \\ & =
		\begin{cases}
			\big(k^\ell - \gamma\big) \psi_i(a^{\ot p}) & i = 2\ell, \\
			\big(k^\ell (1+\rho+\dots+\rho^{k-1}) - \gamma\big) \psi_i(a^{\ot p}) & i = 2\ell+1,
		\end{cases}
		\\ & =
		\begin{cases}
			\big(k^\ell - (-1)^{\bars{a}}\big) \psi_i(a^{\ot p}) & i = 2\ell, \\
			\big(k^{\ell+1} - (-1)^{\bars{a}}\big) \psi_i(a^{\ot p}) & i = 2\ell+1.
		\end{cases}
	\end{align*}
	We conclude the proof of this theorem by noticing the fact that $k^\ell \equiv 1$ mod $p$ if and only if $\ell = r(p-1)$ for some $r$, and $k^\ell \equiv -1$ mod $p$ if and only if $2\ell = (2r+1)(p-1)$ for some $r$.
\end{proof}

\subsection{Thom relators for Barratt--Eccles algebras}

Recall that $\cC(p) = \chains\EE \cyc_p$ and $\BE(p) = \chains\EE \sym_p$ with $\cyc_p$ in $\sym_p$ generated by $\rho$.
Additionally, we write $({s_0},\dots,{s_n})$ instead of $(\rho^{s_0},\dots,\rho^{s_n})$ for elements in $\EE\cyc_p$.

Let $A$ be a Barratt--Eccles algebra with structure map $\phi \colon \BE \to \End(A)$.
Recall from \cref{ss:may-steenrod on barratt-eccles} the map $\iota \colon \cW \to \cC \hookrightarrow \BE$.
The goal of this subsection is to construct a Thom relator by giving explicit equivariant homotopies $L_1$ and $L_2$ making the following diagram commute:
\begin{equation}\label{d:thom_diagram}
	\begin{tikzcd}
		\cW(p) \arrow[r, "\iota"] \arrow[d,"\lambda"] \arrow[dr,phantom,"L_1"] &
		\cC(p) \arrow[r, hook] \arrow[d, "\gamma_\ast"] \arrow[dr,phantom,"L_2"] &
		\BE(p) \arrow[r,"\phi"] \arrow[d,"\gamma"] &
		\Hom(A^{\ot p}, A) \arrow[d,"\gamma"] \\
		\cW(p) \arrow[r, "\iota"] &
		\cC(p) \arrow[r, hook] &
		\BE(p) \arrow[r,"\phi"] &
		\Hom(A^{\ot p}, A),
	\end{tikzcd}
\end{equation}
where the action of $\cyc_r$ on the complexes on the bottom line is via the homomorphism $\rho \mapsto \rho^k$.
Notice that the the top route around the diagram is $\gamma \comp \psi$ and the bottom route is $\psi \comp \lambda$.

\subsubsection{The homotopy $L_1$}

Let us focus on the following part of Diagram~\eqref{d:thom_diagram}
\[
\begin{tikzcd}
	\cW(p) \arrow[r, "\iota"] \arrow[d,"\lambda"] \arrow[dr,phantom,"L_1"] &
	\cC(p) \arrow[d, "\gamma_\ast"]\\
	\cW(p) \arrow[r, "\iota"] &
	\cC(p)
\end{tikzcd}
\]
and define $\mu = \iota \comp \lambda$ and $\nu = \gamma_* \comp \iota$.
Explicitly, these maps are given on basis elements by
\begin{align*}
	\mu(e_{2i}) &= \sum k^i (0,s_1,s_1+1,\ldots,s_i,s_i+1),  \\
	\mu(e_{2i+1}) &= \sum\sum_{j=0}^{k-1} k^i (j,j+1,s_1,s_1+1,\ldots,s_i,s_i+1), \\
	\nu(e_{2i}) &= \sum(0,s_1,s_1+k,\ldots,s_i,s_i+k), \\
	\nu(e_{2i+1}) &= \sum (0,k,s_1,s_1+k,\ldots,s_i,s_i+k). \\
\end{align*}
where the sum iterates over all $(s_1,\ldots,s_i)$ in $\EE\cyc_r$.

Let us consider the idempotent homotopy identity $(\xi,\eta)$ on $\cC(p)$ given by
\[
\xi({s_0},\dots,{s_n}) =
\begin{cases}
	(0) & \text{if } n = 0, \\
	\hfil0 & \text{otherwise}.
\end{cases}
\]
and
\[
\eta({s_0},\dots,{s_n}) = (0,{s_0},\dots,{s_n}).
\]
Notice that $\xi \comp (\mu - \nu) = 0$ so, since $\cW(p)$ has a preferred basis, \cref{t:recursive_homotopy} produces the desired equivariant homotopy $L_1$ recursively.
We will now provide a closed form formula for it.

\begin{lemma*}
	The following are closed form formulas for $L_1$.
	Below $\sum$ stands for the sum over all $s_1,\dots,s_i \in \cyc_p \cong \set{0,\dots,p-1}$ with $s_0 = 0$ being fixed:
	\begin{align*}
		L_1(e_{2i}) =
		- &\sum_{\ell = 1}^i k^{i-\ell} \sum_{j=1}^{k-1} \, \sum \
		\begin{aligned}
			\big(&0,s_1,s_1+k,\ldots,s_{\ell-1},s_{\ell-1}+k, \\
			&s_{\ell},s_{\ell}+j,s_{\ell}+j+1, \\
			&s_{\ell+1},s_{\ell+1}+1,\ldots,s_i,s_i+1\big)
		\end{aligned} \\[5pt]
		L_1(e_{2i+1}) =
		&\sum_{\ell = 1}^i k^{i-\ell} \sum_{j=1}^{k-1} \, \sum \
		\begin{aligned}
			\big(&s_0,s_0+k,\ldots,s_{\ell-1},s_{\ell-1}+k, \\
			&s_{\ell},s_{\ell}+j,s_{\ell}+j+1, \\
			&s_{\ell+1},s_{\ell+1}+1,\ldots,s_i,s_i+1\big)
		\end{aligned}
	\end{align*}
\end{lemma*}

We remark that to obtain $L_1$, the above formulas are extended equivariantly with the action of $\cyc_p$ given by the homomorphisms $\rho \mapsto \rho^k$.
Additionally, we mention that nested sums above are independent of each other.

\begin{proof}
    We will write $L$ instead of $L_1$ to lighten the notation. In degree zero, our formula reduces to $L(e_{0}) = 0$, which agrees with $\eta\circ (\mu - \nu - L\circ \bd)$, because $\mu(e_0) = \nu(e_0)$ and $\bd (e_0) = 0$. For the induction step we distinguish two cases, depending on the parity of the degree.

    \medskip\noindent\emph{Case 1: Odd degree.} Let us assume by induction that our formula for $L(e_{2i})$ is valid, and let us prove that the formula for $L(e_{2i+1})$ agrees with $\eta\circ (\mu - \nu - L\circ \bd)(e_{2i+1})$. Since the first entry of each summand in $\nu(e_{2i+1})$ is $0$, the term $\eta\circ \nu(e_{2i+1})$ vanishes. The term $\eta\circ \mu(e_{2i+1})$ is
    \[
    \sum\sum_{j=1}^{k-1} k^{i-\ell}(0,j,j+1,s_1,s_1+1, \ldots,s_i,s_i+1)
    \]
    \anibal{there seems to be a $-\ell$ wrong above}
    which agrees with the summands indexed by $\ell=0$ of our formula for $L(e_{2i+1})$. Finally, to compute the term $-\eta\circ L\circ \bd(e_{2i+1})$, recall that $\bd (e_{2i+1}) = \rho e_{2i} - e_{2i}$ and observe that all summands in $\eta\circ L(e_{2i})$ have $0$ as first entry, so $\eta\circ L(e_{2i}) = 0$. On the other hand, $\rho L(e_{2i})$ is
    \[
    \sum_{\ell = 1}^i k^{i-\ell} \sum_{j=1}^{k-1} \, \sum \
    \begin{aligned}
    	\big(&k,s_1,s_1+k,\ldots,s_{\ell-1},s_{\ell-1}+k, \\
    	&s_{\ell},s_{\ell}+j,s_{\ell}+j+1, \\
    	&s_{\ell+1},s_{\ell+1}+1,\ldots,s_i,s_i+1\big)
    \end{aligned}
    \]
%    \begin{eqnarray*}
%	    \sum\sum_{\ell = 1}^i\sum_{j=1}^{k-1} k^{i-\ell} (k,s_1,s_1+k,\ldots,s_{\ell-1},s_{\ell-1}+k,s_{\ell},s_{\ell}+j,s_{\ell}+j+1,\\  \qquad\qquad\qquad \qquad \quad s_{\ell+1},s_{\ell+1}+1,\ldots,s_i,s_i+1)
%    \end{eqnarray*}
    because $\rho$ acts on $L(e_{2i})$ adding $k$ to each entry. Thus $\eta(\rho L\circ \bd(e_{2i+1}))$ encompasses all the summands of $L(e_{2i+1})$ indexed by $\ell>0$.
    \anibal{are you sure? It looks different, since $s_0$ doesn't appear.}

    \medskip\noindent\emph{Case 2: Even degree.}
    Let us assume now that our formula is valid for $L(e_{2i-1})$ and let us prove that the formula for $L(e_{2i})$ agrees with $\eta\circ (\mu - \nu - L\circ \bd)(e_{2i})$. Since the first entry of all summands of $\mu(e_{2i})$ and $\nu(e_{2i})$ is $0$, the terms $\eta\circ \mu(e_{2i})$ and $\eta\circ \nu(e_{2i})$ vanish. The term $-L\circ \bd(e_{2i})$ is $-N L(e_{2i-1})$, which can be described with the same formula as $L(e_{2i-1})$, but removing the condition $s_0 = 0$:
    \begin{align*}
        -N L(e_{2i-1}) &= -\sum\sum_{\ell = 0}^{i-1}\sum_{j=1}^{k-1} k^{i-\ell-1} (s_0,s_0+k,\ldots,s_{\ell-1},s_{\ell-1}+k,s_{\ell},s_{\ell}+j,s_{\ell}+j+1, \\ & \qquad\qquad\qquad \qquad \quad s_{\ell+1},s_{\ell+1}+1,\ldots,s_i,s_i+1)
    \end{align*}
	\anibal{Run out of time at the moment to change the format to the three lines I used above.}
    Applying $\eta$ to this sum and renaming each $s_j$ as $s_{j+1}$ and replacing $\ell-1$ by $\ell$, we obtain the formula for $L(e_{2i})$ given in the statement.
 \end{proof}

The first values of $L_1$ for $p=3$ are computed in Table \ref{f:small values of L_1}.

\begin{table}
	\centering
	\input{aux/table3}
	\caption{The elements $L_1(e_n)$ for $p=3, k=2$ and small values of $n$.}
	\label{f:small values of L_1}
\end{table}

\subsubsection{The homotopy $L_2$}

Since $\gamma_\ast \colon \chains\EE\cyc_p \to \chains\EE\cyc_p$ is the restriction of the chain map $\chains\EE\,(-)^\gamma \colon \chains\EE\sym_p \to \chains\EE\sym_p$ induced by $(-)^\gamma$, the conjugation by $\gamma$, it suffices to construct a $\cyc$-equivariant homotopy $L_2 \colon \chains\EE\sym_p \to \chains\EE\sym_p$ from $\chains\EE\,(-)^\gamma$ to $\gamma$, where $\rho$ acts as $\rho^k$ on the target.
We proceed analogously to \cref{ss:K1}.
Let
\[
L_2(\sigma_0,\dots,\sigma_n) = \sum (-1)^i (\sigma_0\gamma,\dots,\sigma_i\gamma,\sigma_i^\gamma,\dots,\sigma_n^\gamma),
\]
which is $\cyc$-equivariant since
\begin{align*}
	(L_2 \comp \rho)(\rho^{s_0},\dots,\rho^{s_n}) &=
	L_2(\rho^{s_0}\rho, \dots, \rho^{s_n}\rho) \\ &=
	\sum (-1)^i (\rho^{s_0} \rho\,\gamma,\dots,\rho^{s_i} \rho\,\gamma,(\rho^{s_i} \rho)^\gamma,\dots,(\rho^{s_n} \rho)^\gamma) \\ &=
	\sum (-1)^i (\rho^{s_0} \gamma \rho^k,\dots,\rho^{s_i} \gamma \rho^k,(\rho^{s_i})^\gamma \rho^k ,\dots,(\rho^{s_n})^\gamma \rho^k) \\ &=
	(\rho^k \comp L_2)(\rho^{s_0},\dots,\rho^{s_n}).
\end{align*}
\anibal{I looked at it without the rhos and it is harder to read}
