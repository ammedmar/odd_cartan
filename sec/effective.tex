% !TEX root = ../odd_cartan.tex

\section{Effective constructions}

In this section we construct an explicit Cartan relator for algebras over the Barratt--Eccles operad, of which the cochains of simplicial sets are natural examples.

\subsection{Barratt--Eccles operad}

We review the main constructions introduced by Berger--Fresse in \cite{berger2004combinatorial}.

Let $\Set$ and $\sSet$ denote the categories of sets and simplicial sets respectively.
The symmetric monoidal functor $\EE \colon \Set \to \sSet$ is defined on objects by $\EE X_n = X^{n+1}$ with
\[
\begin{split}
	\face_i(x_0,\dots,x_n) &= (x_0,\dots,\widehat{x}_i,\dots,x_n), \\
	\dege_i(x_0,\dots,x_n) &= (x_0, \dots, x_i, x_i, \dots, x_n),
\end{split}
\]
and on morphisms by $\EE f_n = f^{\times n}$.
We notice that if $X$ is equipped with a group action then $\EE X$ is as well with
\[
(x_0,\dots,x_n) \cdot g = (x_0 \cdot g, \dots, x_n \cdot g).
\]

The usual block permutation map
\[
\bcirc_{\sym} \colon \sym_r \times \sym_{s_1} \times \cdots \times \sym_{s_r} \to \sym_{s_1+\dots+s_r}
\]
defined for any $r,s_1,\dots,s_r \in \N$ provides $\sym = \{\sym_r\}_{r>0}$ with the structure of an operad in $\Set$.

The simplicial Barratt--Eccles operad $\rE\sym$ is obtained by applying the functor $\EE$ to the operad $\sym$.
We denote its composition by
\[
\bcirc_{\rE\sym} \colon \rE\sym(r) \times \rE\sym(s_1) \times\dots\times \rE\sym(s_r) \to \rE\sym(s_1+\dots+s_r)
\]
for any $r,s_1,\dots,s_r \in \N$.

Let $\chains \colon \sSet \to \Ch$ be the functor of (normalized) chains with integer coefficients.
The linear Barratt--Eccles operad $\cE$ is defined by $\cE(r) = \chains\EE(r)$ and
\[
\bcirc_{\cE} \defeq \bcirc_{\EE} \circ \EZ \colon \cE(r) \ot \cE(s_1) \ot\dotsb\ot \cE(s_r) \to \cE(s_1+\dots+s_r)
\]
for any $r,s_1,\dots,s_r \in \N$.

For any simplicial set $X$, Berger and Fresse explicitly constructed a natural operad morphism
\[
\phi \colon \cE \to \End(\cochains(X))
\]
on its (normalized) cochains.
Since only the existence of this effective construction will be used here, we refer to the original source for details, and to the specialized computer algebra system \texttt{ComCH} for an implementation.

\subsection{May--Steenrod structure on Barratt--Eccles algebras}

To provide the cochains of simplicial sets, or more generally any $\cE$-algebra, with a natural May--Steenrod structure, it suffices to define a $\cyc$-module quasi-isomorphism
\[
\iota \colon \cW \to \cE.
\]
We recall from \cite{medina2021may_st} a closed form formula for one such map which factors through the $\cyc$-module $\chains\EE\cyc = \{\chains\EE\cyc_r\}_{r\in\N}$.
For $r,n\in\N$
\begin{equation*}
	\iota(e_{n}) =
	\begin{cases}
		\displaystyle{\sum_{s_1, \dots, s_m}} \big(0, {s_1}, {s_1+1}, {s_2}, \dots, {s_{m}}, {s_{m}+1} \big) & n = 2m, \\
		\displaystyle{\sum_{s_1, \dots, s_m}} \big(0, 1, {s_1}, {s_1+1}, \dots, {s_{m}}, {s_{m}+1} \big) & n = 2m+1,
	\end{cases}
\end{equation*}
where the sum is over all $s_1, \dots, s_m \in \{0, \dots, r-1\}$ and we are simplifying notation by removing $\rho \in \cyc_r \subset \sym_r$.
Please consult \cref{f:small values of psi} for a few examples.
All construction in this section will be respect to an Barratt--Eccles algebra together with the May--Steenrod structure $\psi$ defined by this map, we will therefore remove $\psi$ from the notation.

\begin{table}
	\centering
	\input{aux/table}
	\caption{The elements $\psi(e_n)$ for small values of $r$ and $n$.}
	\label{f:small values of psi}
\end{table}

\subsection{The lowercase homomorphisms}

We now describe group homomorphisms inducing two chain homotopic $\cyc$-module chain maps.
We will later relate these to the $\cyc$-module chain maps $F$ and $G$ associated to the May--Steenrod structure on $\cE$-algebras.
For $r \in \N$, let
\[
\begin{split}
	&f \colon \cyc_r \to \sym_r \xra{\id \times e^{\times r}} \sym_r \times \sym_2^{\times r} \xra{\bcirc_{\sym}} \sym_{2r}, \\
	&g \colon \cyc_r \to \sym_r \xra{e \times \mathrm{diag}} \sym_2 \times \sym_r \times \sym_r \xra{\bcirc_{\sym}} \sym_{2r}.
\end{split}
\]
Explicitly, if $\rho = (1,2,\dots,r)$ in $\sym_r$ then in $\sym_{2r}$
\begin{align*}
	f(\rho) &= (1,3,\dots,2r-1)(2,4,\dots,2r), \\
	g(\rho) &= (1,2,\dots,r)(r+1,r+2,\dots,2r).
\end{align*}
We notice that
\begin{equation}\label{eq:conjugation of little maps}
	f(\rho) \tau = \tau g(\rho)
\end{equation}
where $\tau$ is as in \cref{ss:reordering}.
We obtain two $\cyc$-module chain maps $\chains\EE f$ and $\chains\EE g$ where the $\cyc_r$ action on $\chains\EE\sym_{2r}$ is induced from Homomorphism \eqref{eq:cyclic to 2-symetric}.

We define a $\cyc$-module chain homotopy $H_1$ between $\chains \EE f \cdot \tau$ and $\chains \EE g$
explicitly as follows.
For $r \in \N$, let $H_1 \colon \chains\EE\cyc_r \to \chains\EE\sym_{2r}$ be given by
\[
H_1(\sigma_0,\dots,\sigma_n) =
\sum_{i=0}^n \ (-1)^i (f(\sigma_0) \tau, \dots, f(\sigma_i) \tau, g(\sigma_i), \dots, g(\sigma_n)).
\]
It can be easily verified that $H_1$ is a homotopy between $\chains \EE f \cdot \tau$ and $\chains \EE g$.
To check that it is $\cyc_r$-equivariant we use \cref{eq:conjugation of little maps} and the fact that $\rho$ acts on $\chains\EE\sym_{2r}$ multiplying on the right by $g(\rho)$.

\subsection{Comparing coproducts}

We now study the failure of the $\cyc$-module quasi-isomorphism $\iota$ to preserve coalgebra structures.
More precisely, we will construct a $\cyc$-module chain homotopy $K$ making the following diagram commute
\begin{equation}\label{d:coproducts}
	\begin{tikzcd}[column sep=large]
		\cW \arrow[r,"\iota"] \arrow[d,"\Delta"] & \chains\EE\cyc \arrow[d,"\Delta_{\AW}"]\\
		\cW^{\ot 2} \arrow[r,"\iota^{\ot 2}"] & \chains\EE\cyc^{\ot 2}.
	\end{tikzcd}
\end{equation}
for every $r \in \N$.
Given $K$, the $\cyc$-module map $H_2$ defined for each $r \in \N$ by
\[
H_2 \colon \cW(r) \xra{K} \cE(r)^{\ot 2} \xra{\psi^2_0 \ot \id} \cE(2) \ot \cE(r)^{\ot 2} \xra{\bcirc_{\cE}} \cE(2r)
\]
is a $\cyc$-module chain homotopy between $G$ and the $\cyc$-module chain map $\widetilde G$ defined for $r \in \N$ by
\[
\widetilde G \colon \cW(r) \xra{\psi(r)} \cE(r) \xra{\psi^2_0 \ot \Delta_{\AW}} \cE(2) \ot \cE(r)^{\ot 2} \xra{\bcirc_{\cE}} \cE(2r).
\]
To construct $K$ we have the following general procedure.

\begin{lemma}
	Let $G$ be a group, $C$ a bounded-below graded chain complex of free $\Z[G]$-modules with a basis, and $D$ a graded chain complex of $\Z[G]$-modules together with a $\Z$-linear endomorphism $\eta$ satisfying for some chain endomorphism $\varepsilon$ that:
	\begin{enumerate}
		\item $\bd \circ \, \eta + \eta \circ \bd = \id_C - \varepsilon$,
		\item $\varepsilon\circ \eta = 0$.
	\end{enumerate}
	Then, for any pair of $\Z[G]$-linear chain maps $\mu,\nu \colon C \to D$ with $\varepsilon \circ (\mu-\nu) = 0$, the $\Z[G]$-linear map $K \colon C \to D$ recursively defined on basis elements by
	\[
	K(b) = \eta \circ (\mu - \nu - K \circ \bd)(b),
	\]
	satisfies
	\[
	\bd \circ \, K + K \circ \bd = \mu - \nu.
	\]
\end{lemma}

\begin{proof}
	We will use an induction argument.
	Suppressing composition symbols we have
	\begin{align*}
		(\bd K+ K\bd)(b)
		&= \bd \eta(\mu-\nu-K\bd)(b) + K\bd(b) \\
		&= (\id_C - \varepsilon - \eta\bd)(\mu-\nu - K\bd)(b) + K\bd(b).
	\end{align*}
	If $b$ is a cycle we are done since $\varepsilon(\mu-\nu) = 0$ by assumption, in particular if $b$ is of lowest degree.
	Since $\varepsilon \eta = 0$ we have $\varepsilon K \bd(b) \defeq \varepsilon \eta(\mu-\nu-K)(\bd b) = 0$ for any $b$.
	Additionally, by the induction assumption $\bd K (\bd b) = (\mu-\nu-K\bd)(\bd b) = (\mu-\nu)(\bd b)$ we have $\eta \bd (\mu-\nu - K\bd)(b) = 0$.
	Therefore, we are left with
	\begin{align*}
		(\bd K+ K\bd)(b) &=
		\id_C(\mu-\nu-K\bd)(b)+K\bd(b) \\&=
		(\mu-\nu)(b)
	\end{align*}
	as desired.
\end{proof}

We can apply this lemma to obtain a homotopy making diagram \eqref{d:coproducts} commute.
Specifically, using the same notation as in the lemma, we have $\mu = (\iota \ot \iota) \circ \Delta$ and $\nu = \Delta_{\AW} \circ \iota$ with
\[
\mu,\nu \colon \cW(r) \to \chains\EE\cyc_r \ot \chains\EE\cyc_r
\]
and
\begin{align*}
	\eta \colon \chains\EE\cyc_r \ot \chains\EE\cyc_r &\to \chains\EE\cyc_r \ot \chains\EE\cyc_r \\
	(s_0,\dots,s_j) \ot (t_0,\dots,t_k) &\mapsto (0,s_0,\dots,s_j) \ot (t_0,\dots,t_k),
\end{align*}
with
\[
\varepsilon(a \ot b) =
\begin{cases}
	\rho^0 \ot b & \text{if } \deg(a \ot b) = 0, \\
	\hfil0 & \text{otherwise}.
\end{cases}
\]
The hypothesis of the lemma are readily verified so we get a recursively defined homotopy $K$.
We present a closed formula in \cref{s:closed formula}.

\subsection{Lower and upper case maps}

It is immediate that
\[
\chains\EE f = F
\]
and that the composition
\[
H_3 \colon \cW(r) \xra{\psi(r)} \cE(r) \xra{\psi^2_0 \ot \Delta_{\mathrm{SHI}}} \cE(2) \ot \cE(r)^{\ot 2} \xra{\bcirc_{\cE}} \cE(2r)
\]
is a $\cyc_r$-equivariant chain homotopy between $\chains\EE g$ and $\widetilde G^p$.

\subsection{Main construction}

\begin{theorem}
	For any algebra over the Barratt--Eccles operad $\phi \colon \cE \to \End(A)$, the map $H = \phi \circ (H_1 + H_2 + H_3)$ is a Cartan relator for $(A,\psi)$.\todo{Maybe the signs are not right here.}
\end{theorem}

\subsection{Examples}

We now show some examples computed using the specialized computer algebra system \texttt{ComCH} \cite{medina2021comch} when $A$ is given by the normalized cochains of a standard simplex, and $\phi$ is the $\cE$-algebra structure of Berger and Fresse.
