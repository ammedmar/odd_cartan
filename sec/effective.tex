% !TEX root = ../odd_cartan.tex

\section{Effective constructions}

In this section we effectively construct natural Cartan coboundaries for the cochains of spaces and, more generally, for algebras over the Barratt--Eccles operad.

\subsection{Barratt--Eccles operad}

We review the main constructions introduced by Berger and Fresse in \cite{berger2004combinatorial}.

Let $\Set$ and $\sSet$ denote the categories of sets and simplicial sets respectively.
The symmetric monoidal functor $\EE \colon \Set \to \sSet$ is defined on objects by $\EE X_n = X^{n+1}$ with
\[
\begin{split}
	\face_i(x_0,\dots,x_n) &= (x_0,\dots,\widehat{x}_i,\dots,x_n), \\
	\dege_i(x_0,\dots,x_n) &= (x_0, \dots, x_i, x_i, \dots, x_n),
\end{split}
\]
and on morphisms by $\EE f_n = f^{\times n}$.
We notice that if $X$ is equipped with a group action then $\EE X$ is as well with
\[
(x_0,\dots,x_n) \cdot g = (x_0 \cdot g, \dots, x_n \cdot g).
\]

The usual block permutation map
\[
\bcirc_{\sym} \colon \sym_r \times \sym_{s_1} \times \cdots \times \sym_{s_r} \to \sym_{s_1+\dots+s_r}
\]
defined for any $r,s_1,\dots,s_r \in \N$ provides $\sym = \{\sym_r\}_{r>0}$ with the structure of an operad in $\Set$.

The simplicial Barratt--Eccles operad $\rE\sym$ is obtained by applying the functor $\EE$ to the operad $\sym$.
We denote its composition by
\[
\bcirc_{\rE\sym} \colon \rE\sym(r) \times \rE\sym(s_1) \times\dots\times \rE\sym(s_r) \to \rE\sym(s_1+\dots+s_r)
\]
for any $r,s_1,\dots,s_r \in \N$.

Let $\chains \colon \sSet \to \Ch$ be the functor of (normalized) chains with integer coefficients.
The linear Barratt--Eccles operad $\BE$ is defined by $\BE(r) = \chains\EE(r)$ and
\[
\bcirc_{\BE} \defeq \bcirc_{\EE} \circ \EZ \colon \BE(r) \ot \BE(s_1) \ot\dotsb\ot \BE(s_r) \to \BE(s_1+\dots+s_r)
\]
for any $r,s_1,\dots,s_r \in \N$.

For any simplicial set $X$, Berger and Fresse explicitly constructed a natural operad morphism
\[
\phi \colon \BE \to \End(\cochains(X))
\]
on its (normalized) cochains.
Since only the existence of this effective construction will be used here, we refer to the original source for details, and to the specialized computer algebra system \texttt{ComCH} for an implementation.

\subsection{May--Steenrod structure on Barratt--Eccles algebras}

To provide the cochains of simplicial sets, or more generally any $\BE$-algebra, with a natural May--Steenrod structure, it suffices to define a $\cyc$-module quasi-isomorphism
\[
\iota \colon \cW \to \BE.
\]
We recall from \cite{medina2021may_st} a closed form formula for one such map which factors through the $\cyc$-module $\cC = \{\chains\EE\cyc_r\}_{r\in\N}$.
For $r,n\in\N$, let
\begin{equation*}
	\iota(e_{n}) =
	\begin{cases}
		\displaystyle{\sum_{s_1, \dots, s_m}} \big(0, {s_1}, {s_1+1}, {s_2}, \dots, {s_{m}}, {s_{m}+1} \big) & n = 2m, \\
		\displaystyle{\sum_{s_1, \dots, s_m}} \big(0, 1, {s_1}, {s_1+1}, \dots, {s_{m}}, {s_{m}+1} \big) & n = 2m+1,
	\end{cases}
\end{equation*}
where the sum is over all $s_1, \dots, s_m \in \{0, \dots, r-1\} \cong \cyc_r$.
Please consult \cref{f:small values of psi} for a few examples.

\begin{table}
	\centering
	\input{aux/table}
	\caption{The elements $\psi(e_n)$ for small values of $r$ and $n$.}
	\label{f:small values of psi}
\end{table}

Given a Barratt--Eccles algebra $\phi \colon \BE \to \End(A)$ we will consider $A$ as a May--Steenrod complex with the structure induced by $\phi$ and $\iota$.

\subsection{Main diagram}

Our goal is to construct a natural Cartan relator for $\BE$-algebras, that is to say, a natural $\cyc$-module chain homotopy $H \colon \cW \to \End(A)^\vee$ from $\tau F$ to $G$ for any such $A$.
We will do so by constructing $\cyc_r$-equivariant chain homotopies $K_1$, $K_2$, and $K_3$ in the following diagram:
\begin{equation}\label{d:big diagram}
	\input{sec/diagram}
\end{equation}
where the top and bottom compositions are respectively $\tau F$ and $G$, and $e$ denotes the identity in degree $0$.

\subsection{The chain homotopy $K_1$}

Let us focus on the following part of Diagram \eqref{d:big diagram}:
\[
\begin{tikzcd}[column sep=large]
	\cC(r)
	\arrow[r,bend left,"\chains\EE f \cdot \tau"]
	\arrow[r,bend right,"\chains\EE g"']
	\arrow[r,phantom,"K_1"]
	& \BE(2r).
\end{tikzcd}
\]
For $r \in \N$, let $f,g \colon \cyc_r \to \sym_{2r}$ be the following group homomorphisms:
\[
\begin{split}
	&f \colon \cyc_r \hookrightarrow \sym_r \xra{\id \times e^r} \sym_r \times \sym_2^r \xra{\bcirc_{\sym}} \sym_{2r}\,, \\
	&g \colon \cyc_r \hookrightarrow \sym_r \xra{e \times \rD} \sym_2 \times \sym_r \times \sym_r \xra{\bcirc_{\sym}} \sym_{2r}\,,
\end{split}
\]
where $e$ denotes the identity element.
Explicitly,
\begin{align*}
	f(\rho) &= (1,3,\dots,2r-1)(2,4,\dots,2r), \\
	g(\rho) &= (1,2,\dots,r)(r+1,r+2,\dots,2r),
\end{align*}
where $\rho = (1,2,\dots,r)$ is the chosen order-$r$ permutation.
Please notice the following identity involving the reordering $\tau$ of \cref{ss:reordering}:
\begin{equation}\label{eq:conjugation of little maps}
	f(\rho) \tau = \tau g(\rho).
\end{equation}

The map defined by
\[
K_1(a_0,\dots,a_n) =
\sum_{i=0}^n \ (-1)^i (f(a_0) \tau, \dots, f(a_i) \tau, g(a_i), \dots, g(a_n))
\]
can be directly seen to be a chain homotopy from $(\chains \EE f) \cdot \tau$ to $\chains \EE g$, and we can use \cref{eq:conjugation of little maps} together with the fact that $\rho$ acts on $\BE(2r)$ multiplying on the right by $g(\rho)$ to observe that $K_1$ is $\cyc_r$-equivariant.

\subsection{The chain homotopy $K_2$}

Let us now focus on the following part of Diagram~\eqref{d:big diagram}:
\[
\begin{tikzcd}
	\cC(r)
	\arrow[r,"\chains\EE g"]
	\arrow[d,"\Delta_{\AW}"']
	\arrow[ddr,phantom,"K_2",shift left=0pt]
	&[15pt] \BE(2r)
	\\
	\cC(r)^{\ot 2}
	\arrow[d,hook] & \\
	\BE(r)^{\ot 2}
	\arrow[r,"e\, \ot\, \id"]
	& \BE(2) \ot \BE(r)^{\ot 2}.
	\arrow[uu,"\bcirc_\BE"']
\end{tikzcd}
\]

Using that the functor $\EE$ is symmetric monoidal, this diagram can be seen to be equivalent to the following one in the sense that the top and bottom compositions agree:
\[
\begin{tikzcd}
	\chains\EE\cyc_r
	\rar[hook]
	&[-10pt]
	\chains\EE\sym_r
	\rar["\chains\EE\rD"]
	\arrow[dr,in=180,out=-90,"\Delta_{\AW}"'] &
	\chains\EE\sym_r^2
	\rar["\chains\EE \, e \times \id"]
	\dar["\AW"'] &[0pt]
	\chains\EE(\sym_2 \times \sym_r^2)
	\rar["\chains\bcirc_{\EE\!\sym}"]
	\dar["\AW"']
	\drar["\id",out=-10,in=150] &
	\chains\EE\sym_{2r} \\ & &
	\chains\EE\sym_r^{\ \ot 2}
	\rar["e \,\ot\, \id"] &
	\chains\EE\sym_2 \ot \chains\EE\sym_r^{\ \ot 2}
	\rar["\EZ"]
	\uar["\Shi",phantom,shift right=30pt] &
	\chains\EE(\sym_2 \times \sym_r^2)
	\uar["\chains\bcirc_{\EE\!\sym}"']
\end{tikzcd}
\]
Therefore, it suffices to define
\[
K_2 = \chains\bcirc_{\EE\sym} \circ \Shi \circ \chains\EE(e \times \id) \circ \chains\EE\rD
\]
as the desired $\cyc_r$-equivariant chain homotopy.

\subsection{The chain homotopy $K_3$} \label{ss:coproduct}

We now study the failure of the $\cyc$-module quasi-isomorphism $\iota$ to preserve coalgebra structures.
More precisely, we will construct a $\cyc$-module chain homotopy $K_3$ making the following diagram commute:
\begin{equation}\label{d:coproducts}
	\begin{tikzcd}[column sep=large]
			\cW \arrow[r,"\iota"] \arrow[d,"\Delta"'] \arrow[dr,phantom,"K_3"]&
			\cC \arrow[d,"\Delta_{\AW}"] \\
			\cW^{\ot 2} \arrow[r,"\iota^{\ot 2}"'] &
			\cC^{\ot 2}.
		\end{tikzcd}
\end{equation}

Using the bijection $\cyc_r \cong \set{0,\dots,r-1}$, we denote by $\alpha(a_1,\dots,a_\ell)$ the number of increasing consecutive pairs $a_i < a_{i+1}$ in a basis element of $\cC(r)$.
For two such elements $(s_1,\dots,s_j)$ and $(t_1,\dots,t_k)$ we denote respectively by $\varphi(0,s_1,\dots,s_j;t_1,\dots,t_k)$ and $\varphi(1,s_1,\dots,s_j;t_1,\dots,t_k)$ the following expressions in $\cC(r) \ot \cC(r)$:
\[
\alpha(s_1,\dots,s_j,t_1) \cdot
(0,s_1,s_1+1,\dots,s_j,s_j+1) \ot
(t_1,t_1+1,\dots,t_k,t_k+1),
\]
and
\[
- \alpha(s_1-1,\dots,s_j-1,t_1-1) \cdot
(0,1,s_1,s_1+1,\dots,s_j,s_j+1)\otimes (t_1,t_1+1,\dots,t_k,t_k+1).
\]
Then, the chain homotopy $K_3$ is defined by
\[
\begin{split}
	K_3(e_{2i})   &= \sum \, \varphi(0,s_1,\dots,s_j;t_1,\dots,t_k), \\
	K_3(e_{2i+1}) &= \sum \, \varphi(1,s_1,\dots,s_j;t_1,\dots,t_k),
\end{split}
\]
where the sums are taken over all $s_1,\dots,s_j,t_1,\dots,t_k \in \cyc_r$ with $i+1 = j+k$.
Please consult \cref{f:small values of K} for a few example.

The verification that $K_3$ is a $\cyc_r$-equivariant chain homotopy from $(\iota\otimes \iota)\circ \Delta$ to $\Delta_{\AW}\circ \iota$ is done through an arduous computation presented in \cref{s:postponed}.

\begin{table}
	\centering
	\input{aux/table2}
	\caption{The elements $K_3(e_n)$ for small values of $r$ and $n$. For $r=2$ or $n<2$ all vanish. Notice that the indices are flipped with respect to \cref{f:small values of psi}.}
	\label{f:small values of K}
\end{table}

\subsection{Main construction}

We now bring these constructions together using Diagram~\eqref{d:big diagram}.

\begin{theorem*}
	Let $A$ be a Barratt--Eccles algebra with structure map $\phi$.
	Then,
	\[
	H = \phi \circ K_1 \circ \iota \ +\ \phi \circ K_2 \circ \iota \ +\ \phi \circ \bcirc_{\BE} \circ (e \ot \id)\circ K_3
	\]
	is a natural Cartan relator for $A$.
\end{theorem*}

\subsection{Examples}

We now show some examples computed using the specialized computer algebra system \texttt{ComCH} \cite{medina2021comch} when $A$ is given by the normalized cochains of a standard simplex, and $\phi$ is the $\BE$-algebra structure of Berger and Fresse.
