% !TEX root = ../odd_cartan.tex

\section{Revisiting $K_3$}\label{s:postponed}

In this section we prove that $K_3 \colon \cW(r) \to \cC(r) \ot \cC(r)$, as defined in \cref{ss:coproduct}, is a $\cyc$-equivariant chain homotopy between $(\iota \ot \iota) \circ \Delta$ and $\Delta_{\AW} \circ \iota$.

\subsection{The recursively defined chain homotopy $K$}

We can apply the recursive construction of the previous section to obtain a $\cyc$-equivariant homotopy $K$ making the following diagram commute:
\begin{equation*}
	\begin{tikzcd}[column sep=large]
		\cW \arrow[r,"\iota"] \arrow[d,"\Delta"'] \arrow[dr,phantom,"K"]&
		\cC \arrow[d,"\Delta_{\AW}"] \\
		\cW^{\ot 2} \arrow[r,"\iota^{\ot 2}"'] &
		\cC^{\ot 2}.
	\end{tikzcd}
\end{equation*}
To do so, we consider the map $\xi$ and $\eta$ on $\cC(r) \ot \cC(r)$ given by
\[
\xi(s \ot t) =
\begin{cases}
	(0) \ot t & \text{if } \deg(s \ot t) = 0, \\
	\hfil0 & \text{otherwise}.
\end{cases}
\]
and
\[
\eta \big((s_0,\dots,s_j) \ot (t_0,\dots,t_k)\big) = (0,s_0,\dots,s_j) \ot (t_0,\dots,t_k)
\]
respectively, and denote by $\mu = (\iota \ot \iota) \circ \Delta$ and $\nu = \Delta_{\AW} \circ \iota$.

The following claim is easily verified.
\begin{lemma*}
	The pair $(\xi,\eta)$ is an idempotent homotopy identity and
	\[
	\xi \circ (\mu - \nu) = 0.
	\]
\end{lemma*}
Since $\cW(r)$ has a preferred basis, \cref{t:recursive construction} applies and produces the desired equivariant chain homotopy $K$.

\subsection{A closed formula for $K$}\label{ss:closed formula for K}

Using the bijection $\cyc_r\cong\{0,1,\dots,r-1\}$ the group $\cyc_r$ receives a total order.
Consider additionally the cyclic order on $\cyc_r$, which is a ternary relation given on elements $a,b,c\in \{0,1,\dots,r-1\}$ as follows: $a\prec b\prec c$
if there are representatives $\bar{a},\bar{b},\bar{c}$ of the classes $[a],[b],[c]$ in $\Z_r$ such that $\bar{a}<\bar{b}<\bar{c}<\bar{a}+r$.

For $(s_1,\dots,s_j)$ in $\EE\cyc_r$ we use the following notation:
\[
s_q^- =
\begin{cases}
	s_{q-1}+1 & \text{if } q>1, \\
	0 & \text{if } q=1,
\end{cases}
\]
and for each $1\leq q\leq j$, write $\theta_q(0,s_1,\dots,s_j;t_1,\dots,t_k)$ for
\[
(0,s_1,s_1+1,\dots,s_j,s_j+1)\ot (t_1,t_1+1,\dots,t_k,t_k+1)
\]
if $s_q^- \prec s_q \prec t_1$ and $0$ otherwise, and $\theta_q(1,s_1,\dots,s_j;t_1,\dots,t_k)$ for
\[
(0,1,s_1,s_1+1,\dots,s_j,s_j+1)\ot (t_1,t_1+1,\dots,t_k,t_k+1)
\]
if $s_q^--1 \prec s_q-1 \prec t_1-1$ and $0$ otherwise.

\begin{lemma*}
	The map $K$ is defined by the following expressions
	\begin{align} \label{eq:homotopyK'1}
		K(e_{2i}) &= \sum_{i+1 = j+k} \sum_{q=1}^j \
		\theta_q(0,s_1,\dots,s_j;t_1,\dots,t_k), \\ \label{eq:homotopyK'2}
		K(e_{2i+1}) &= -\sum_{i+1 = j+k} \sum_{q=1}^j \
		\theta_q(1,s_1,\dots,s_j;t_1,\dots,t_k),
	\end{align}
	where the sum is taken over all $s_1,\dots,s_j,t_1,\dots,t_k\in \{0,1,\dots,r-1\}$.
\end{lemma*}

\begin{proof}
 	Let us proceed by induction.
	In degree $0$ we have that $\mu(e_0) = \nu(e_0) = 0\ot 0$, therefore we have that
	\[K(e_0) = \eta \circ (\mu-\nu-K \circ \partial)(e_0) = 0.\]
	which agrees with \eqref{eq:homotopyK'1} for $i=0$.
	Assume now that we have proven that the homotopy has that form up to degree $2i$ with $i\geq 0$.
	Then
	\[K(e_{2i+1}) = \eta \circ (\mu-\nu-K \circ \partial)(e_{2i+1}).\]
	Since $\eta \circ \nu(e_{2i+1}) = 0$ and $\eta \circ \mu(e_{2i+1}) = 0$, we are left with
	\[-\eta \circ K \circ \partial(e_{2i+1}) = -\eta \circ K (\rho e_{2i+1}) + \eta \circ K (e_{2i+1}).
	\]
	The second summand vanishes, because all terms in $K(e_{2i+1})$ start with $0$, and the first summand is precisely the formula \eqref{eq:homotopyK'2}.

	Assume now that we have proven that the homotopy has that form up to degree $2i-1$ with $i>0$.
	Then
	\[K(e_{2i}) = \eta \circ (\mu-\nu-K \circ \partial)(e_{2i}).\]
	Again, $\eta \circ \nu(e_{2i}) = 0$, but now a careful look reveals that
	\begin{equation}\label{eq:hK1}\eta \circ \mu(e_{2i}) = \sum_{j+k=i+1}\theta_1(0,s_1,\dots,s_j;t_1,\dots,t_j).
	\end{equation}
	Regarding the summand $\eta \circ K \circ \partial(e_{2i})$, we have
	\[\eta(N\theta_q(1,s_1,\dots,s_j,t_1,\dots,t_k)) = \sum_{s_1' = 1}^{r-1}\theta_{q+1}(0,s_1',s_2',\dots,s_{j+1}';t_1,\dots,t_k),\]
	where $s_{i+1}' = s_i$ for $i\geq 1$, and therefore
	\begin{align*} \label{eq:hK2}
		-\eta \circ K \circ \partial(e_{2i})
		&= -\eta\left(-\sum_{j+k = i}\sum_{q=1}^j N\theta_q(1,s_1,\dots,s_j;t_1,\dots,t_k)\right) \\
		&= \sum_{j+k = i+1}\sum_{q=2}^{j+1}\theta_q(0,s_1,\dots,s_{j+1};t_1,\dots,t_k).
	\end{align*}
	Putting together this last formula and \eqref{eq:hK1}, we obtain the formula \eqref{eq:homotopyK'1}.
\end{proof}

\subsection{Comparing $K$ and $K_3$}\label{ss:comparins K and K3}

The agreement of $K$ and $K_3$ follows from the following.

\begin{lemma*}
	For any $(s_1,\dots,s_j)$ and $(t_1,\dots,t_k)$ in $\EE\cyc_r$ we have:
	\begin{align*}
		\varphi(0,s_1,\dots,s_j;t_1,\dots,t_k) &= \sum_{q=1}^j \theta_q(0,s_1,\dots,s_j;t_1,\dots,t_k) \\
		\varphi(1,s_1,\dots,s_j;t_1,\dots,t_k) &= -\sum_{q=1}^j \theta_q(1,s_1,\dots,s_j;t_1,\dots,t_k).
	\end{align*}
\end{lemma*}

\begin{proof}
	Observe first that if $s_{i+1} = s_i+1$ for some $i$, or $s_1 = 0$ (in the first case) or $s_1=1$ (in the second case) we get degenerate summands, so we do not treat these cases in the following computations.
	For a number $a\in \{0,1,\dots,r-1\}$, we will write $[a]$ for the class of $a$ in $\Z_{r}$.

	\vspace*{5pt}\noindent\textit{First case}.
	Let $(s_1',\dots,s'_j)$ be the only sequence of integers such that:
	\begin{enumerate}
		\item $[s'_i] = [s_i]$,
		\item $0< s_1'< r$,
		\item $1 < s_{i+1}' - s_i' \leq r$.
	\end{enumerate}
	Then $\theta_q(0,s_1,\dots,s_j;t_1,\dots,t_k)$ will vanish for $q>1$ if and only if the interval $(s_{q-1}',s_q']$ contains a representative of $[t_1]$, and will vanish for $q=1$ if and only if the interval $[0,s_1']$ contains a representative of $[t_1]$.
	Therefore the number of vanishing summands in $\sum_{q=1}^j\theta_q(0,s_1,\dots,s_j;t_1,\dots,t_k)$ equals the number $Q$ of representatives of $[t_1]$ that lie in the interval $[0,s_j']$, which in turn is computed by
	\[
	Q =
	\begin{cases}
		\card\set{s_i \geq s_{i+1}} & \text{if } t_1 > s_j, \\
		\card\set{s_i \geq s_{i+1}} + 1 & \text{if } t_1 \leq s_j.
	\end{cases}
	\]
	Hence, the number of non-vanishing summands in $\sum_{q=1}^j\theta_q(0,s_1,\dots,s_j;t_1,\dots,t_k)$ is $j-Q$, which equals $\alpha(s_1,\dots,s_j,t_1)$.

	\vspace*{5pt}\noindent\textit{Second case}.
	It follows from the definition of $\theta_q$ that the number of non-vanishing summands in $\sum_{q=1}^j \theta_q(1,s_1,\dots,s_j;t_1,\dots,t_k)$ equals the number of non-vanishing summands in
	\[
	\sum_{q=1}^j \theta_q(0,s_1-1,\dots,s_j-1;t_1-1,\dots,t_k-1),
	\]
	which by the previous case equals $\alpha(s_1-1,\dots,s_j-1,t_1-1)$.
\end{proof}